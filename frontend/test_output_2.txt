
> frontend@0.0.0 test
> vitest run


 RUN  v3.2.4 /Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Initial Load > attempts to refresh token on mount
[2025-11-22T03:34:57.297Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Initial Load > sets user when refresh token succeeds
[2025-11-22T03:34:57.303Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/admin/InitialPasswordModal.test.tsx > InitialPasswordModal > Copy Functionality > should copy password to clipboard when copy button is clicked
[2025-11-22T03:34:57.307Z] INFO: Initial password copied to clipboard

stdout | src/components/admin/InitialPasswordModal.test.tsx > InitialPasswordModal > Copy Functionality > should change button text to "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ" after copying
[2025-11-22T03:34:57.312Z] INFO: Initial password copied to clipboard

 âœ“ src/components/RoleBasedRedirect.test.tsx (15 tests) 31ms
stdout | src/components/admin/InitialPasswordModal.test.tsx > InitialPasswordModal > Copy Functionality > should disable copy button after copying
[2025-11-22T03:34:57.319Z] INFO: Initial password copied to clipboard

stdout | src/components/admin/InitialPasswordModal.test.tsx > InitialPasswordModal > Copy Functionality > should reset button text after 2 seconds
[2025-11-22T03:34:57.325Z] INFO: Initial password copied to clipboard

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Initial Load > stays unauthenticated when refresh token fails
[2025-11-22T03:34:57.357Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Authenticated State > renders children when authenticated
[2025-11-22T03:34:57.367Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Authenticated State > does not show loading spinner when authenticated
[2025-11-22T03:34:57.373Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Authenticated State > does not redirect when authenticated
[2025-11-22T03:34:57.378Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Authenticated State > renders multiple children when authenticated
[2025-11-22T03:34:57.383Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Unauthenticated State > redirects to login when not authenticated
[2025-11-22T03:34:57.386Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Unauthenticated State > does not render children when not authenticated
[2025-11-22T03:34:57.394Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Unauthenticated State > does not show loading spinner after redirect
[2025-11-22T03:34:57.395Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > State Transitions > transitions from loading to authenticated
[2025-11-22T03:34:57.399Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > State Transitions > transitions from loading to unauthenticated
[2025-11-22T03:34:57.405Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Initial Load > sets isLoading to true initially
[2025-11-22T03:34:57.410Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Initial Load > sets isLoading to false after refresh attempt
[2025-11-22T03:34:57.411Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Navigation Behavior > redirects to /login path
[2025-11-22T03:34:57.411Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Navigation Behavior > uses replace navigation to prevent back button issues
[2025-11-22T03:34:57.416Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Navigation Behavior > works with different initial paths
[2025-11-22T03:34:57.421Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Integration with AuthContext > uses isLoading from AuthContext
[2025-11-22T03:34:57.426Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Integration with AuthContext > uses isAuthenticated from AuthContext
[2025-11-22T03:34:57.432Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

 âœ“ src/components/PageHeader.test.tsx (15 tests) 58ms
stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Integration with AuthContext > respects AuthContext authentication state changes
[2025-11-22T03:34:57.435Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Edge Cases > handles empty children
[2025-11-22T03:34:57.440Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Edge Cases > handles complex nested children
[2025-11-22T03:34:57.444Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/ProtectedRoute.test.tsx > ProtectedRoute > Multiple ProtectedRoutes > handles multiple protected routes independently
[2025-11-22T03:34:57.449Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

 âœ“ src/components/ProtectedRoute.test.tsx (22 tests) 110ms
 âœ“ src/components/ErrorBoundary.test.tsx (24 tests) 113ms
stdout | src/contexts/AuthContext.test.tsx > AuthContext > Login > logs in successfully with valid credentials
[2025-11-22T03:34:57.464Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Login > logs in successfully with valid credentials
[2025-11-22T03:34:57.515Z] INFO: User logged in {"userId":1,"email":"test@example.com","role":"user"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Login > throws error when login fails
[2025-11-22T03:34:57.570Z] DEBUG: Not authenticated on mount {"error":{}}

stderr | src/contexts/AuthContext.test.tsx > AuthContext > Login > throws error when login fails
[2025-11-22T03:34:57.622Z] ERROR: Login failed Error: Invalid credentials
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/contexts/AuthContext.test.tsx:102:52
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Login > updates user state after successful login
[2025-11-22T03:34:57.627Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Login > updates user state after successful login
[2025-11-22T03:34:57.679Z] INFO: User logged in {"userId":1,"email":"test@example.com","role":"user"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Logout > logs out successfully
[2025-11-22T03:34:57.731Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Logout > logs out successfully
[2025-11-22T03:34:57.783Z] INFO: User logged out

stdout | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should call changePassword API with correct data
[2025-11-22T03:34:57.804Z] INFO: Password changed successfully

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Logout > clears user state even when logout API call fails
[2025-11-22T03:34:57.836Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

 âœ“ src/lib/utils/dateFormat.test.ts (10 tests) 16ms
stdout | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should call onSuccess after successful password change
[2025-11-22T03:34:57.871Z] INFO: Password changed successfully

stderr | src/contexts/AuthContext.test.tsx > AuthContext > Logout > clears user state even when logout API call fails
[2025-11-22T03:34:57.889Z] ERROR: Logout failed Error: Logout failed
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/contexts/AuthContext.test.tsx:156:53
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > fetches users successfully
[2025-11-22T03:34:57.916Z] DEBUG: API Request: GET /api/users

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > fetches users successfully
[2025-11-22T03:34:57.917Z] DEBUG: API Response: GET /api/users - 200 (1.03ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > login > logs in successfully with valid credentials
[2025-11-22T03:34:57.917Z] DEBUG: API Request: POST /api/auth/login

stdout | src/lib/api/auth.test.ts > API Client - auth > login > logs in successfully with valid credentials
[2025-11-22T03:34:57.917Z] DEBUG: API Response: POST /api/auth/login - 200 (0.97ms)

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > returns empty array when no users exist
[2025-11-22T03:34:57.919Z] DEBUG: API Request: GET /api/users

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > returns empty array when no users exist
[2025-11-22T03:34:57.919Z] DEBUG: API Response: GET /api/users - 200 (0.11ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on invalid credentials
[2025-11-22T03:34:57.919Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on invalid credentials
[2025-11-22T03:34:57.919Z] WARN: API Response: POST /api/auth/login - 401 (0.30ms)

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on unauthorized access
[2025-11-22T03:34:57.919Z] DEBUG: API Request: GET /api/users

stderr | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on unauthorized access
[2025-11-22T03:34:57.920Z] WARN: API Response: GET /api/users - 403 (0.28ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on invalid credentials
[2025-11-22T03:34:57.920Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on invalid credentials
[2025-11-22T03:34:57.920Z] WARN: API Response: POST /api/auth/login - 401 (0.08ms)

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on unauthorized access
[2025-11-22T03:34:57.920Z] DEBUG: API Request: GET /api/users

stderr | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on unauthorized access
[2025-11-22T03:34:57.920Z] WARN: API Response: GET /api/users - 403 (0.07ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on server error
[2025-11-22T03:34:57.920Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > login > throws ApiError on server error
[2025-11-22T03:34:57.920Z] WARN: API Response: POST /api/auth/login - 500 (0.08ms)

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on server error
[2025-11-22T03:34:57.920Z] DEBUG: API Request: GET /api/users

stderr | src/lib/api/users.test.ts > API Client - users > fetchUsers > throws ApiError on server error
[2025-11-22T03:34:57.921Z] WARN: API Response: GET /api/users - 500 (0.10ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > login > includes credentials in request
[2025-11-22T03:34:57.921Z] DEBUG: API Request: POST /api/auth/login

stdout | src/lib/api/auth.test.ts > API Client - auth > login > includes credentials in request
[2025-11-22T03:34:57.921Z] DEBUG: API Response: POST /api/auth/login - 200 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > includes credentials in request
[2025-11-22T03:34:57.921Z] DEBUG: API Request: GET /api/users

stdout | src/lib/api/users.test.ts > API Client - users > fetchUsers > includes credentials in request
[2025-11-22T03:34:57.921Z] DEBUG: API Response: GET /api/users - 200 (0.06ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > logs out successfully
[2025-11-22T03:34:57.922Z] DEBUG: API Request: POST /api/auth/logout

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > logs out successfully
[2025-11-22T03:34:57.922Z] DEBUG: API Response: POST /api/auth/logout - 200 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > creates user successfully and returns initial password
[2025-11-22T03:34:57.922Z] DEBUG: API Request: POST /api/users

stdout | src/lib/api/users.test.ts > API Client - users > createUser > creates user successfully and returns initial password
[2025-11-22T03:34:57.922Z] DEBUG: API Response: POST /api/users - 201 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > throws ApiError on logout failure
[2025-11-22T03:34:57.922Z] DEBUG: API Request: POST /api/auth/logout

stderr | src/lib/api/auth.test.ts > API Client - auth > logout > throws ApiError on logout failure
[2025-11-22T03:34:57.922Z] WARN: API Response: POST /api/auth/logout - 500 (0.08ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > throws ApiError on logout failure
[2025-11-22T03:34:57.922Z] DEBUG: API Request: POST /api/auth/logout

stderr | src/lib/api/auth.test.ts > API Client - auth > logout > throws ApiError on logout failure
[2025-11-22T03:34:57.922Z] WARN: API Response: POST /api/auth/logout - 500 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on validation error
[2025-11-22T03:34:57.922Z] DEBUG: API Request: POST /api/users

stderr | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on validation error
[2025-11-22T03:34:57.922Z] WARN: API Response: POST /api/users - 400 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on validation error
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/users

stderr | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on validation error
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/users - 400 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > includes credentials in request
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/auth/logout

stdout | src/lib/api/auth.test.ts > API Client - auth > logout > includes credentials in request
[2025-11-22T03:34:57.923Z] DEBUG: API Response: POST /api/auth/logout - 200 (0.03ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on duplicate email
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/users

stderr | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on duplicate email
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/users - 409 (0.06ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > refreshes token successfully
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/auth/refresh

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > refreshes token successfully
[2025-11-22T03:34:57.923Z] DEBUG: API Response: POST /api/auth/refresh - 200 (0.04ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on unauthorized access
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/users

stderr | src/lib/api/users.test.ts > API Client - users > createUser > throws ApiError on unauthorized access
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/users - 403 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is invalid
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/auth/refresh

stderr | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is invalid
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/auth/refresh - 401 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is invalid
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/auth/refresh

stderr | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is invalid
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/auth/refresh - 401 (0.04ms)

stdout | src/lib/api/users.test.ts > API Client - users > createUser > includes credentials in request
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/users

stdout | src/lib/api/users.test.ts > API Client - users > createUser > includes credentials in request
[2025-11-22T03:34:57.923Z] DEBUG: API Response: POST /api/users - 200 (0.03ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is expired
[2025-11-22T03:34:57.923Z] DEBUG: API Request: POST /api/auth/refresh

stderr | src/lib/api/auth.test.ts > API Client - auth > refreshToken > throws ApiError when refresh token is expired
[2025-11-22T03:34:57.923Z] WARN: API Response: POST /api/auth/refresh - 401 (0.05ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > deletes user successfully
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/3

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > deletes user successfully
[2025-11-22T03:34:57.924Z] DEBUG: API Response: DELETE /api/users/3 - 204 (0.03ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > includes credentials in request
[2025-11-22T03:34:57.924Z] DEBUG: API Request: POST /api/auth/refresh

stdout | src/lib/api/auth.test.ts > API Client - auth > refreshToken > includes credentials in request
[2025-11-22T03:34:57.924Z] DEBUG: API Response: POST /api/auth/refresh - 200 (0.03ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on user not found
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/999

stderr | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on user not found
[2025-11-22T03:34:57.924Z] WARN: API Response: DELETE /api/users/999 - 404 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on user not found
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/999

stderr | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on user not found
[2025-11-22T03:34:57.924Z] WARN: API Response: DELETE /api/users/999 - 404 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > Data mapping > correctly maps UserDto to User
[2025-11-22T03:34:57.924Z] DEBUG: API Request: POST /api/auth/login

stdout | src/lib/api/auth.test.ts > API Client - auth > Data mapping > correctly maps UserDto to User
[2025-11-22T03:34:57.924Z] DEBUG: API Response: POST /api/auth/login - 200 (0.03ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError when trying to delete admin
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/1

stderr | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError when trying to delete admin
[2025-11-22T03:34:57.924Z] WARN: API Response: DELETE /api/users/1 - 403 (0.07ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles malformed JSON response
[2025-11-22T03:34:57.924Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles malformed JSON response
[2025-11-22T03:34:57.924Z] WARN: API Response: POST /api/auth/login - 500 (0.06ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on unauthorized access
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/3

stderr | src/lib/api/users.test.ts > API Client - users > deleteUser > throws ApiError on unauthorized access
[2025-11-22T03:34:57.924Z] WARN: API Response: DELETE /api/users/3 - 403 (0.05ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles empty error response
[2025-11-22T03:34:57.924Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles empty error response
[2025-11-22T03:34:57.924Z] WARN: API Response: POST /api/auth/login - 500 (0.05ms)

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > includes credentials in request
[2025-11-22T03:34:57.924Z] DEBUG: API Request: DELETE /api/users/3

stdout | src/lib/api/users.test.ts > API Client - users > deleteUser > includes credentials in request
[2025-11-22T03:34:57.924Z] DEBUG: API Response: DELETE /api/users/3 - 204 (0.02ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles network error
[2025-11-22T03:34:57.925Z] DEBUG: API Request: POST /api/auth/login

 âœ“ src/lib/api/users.test.ts (15 tests) 10ms
stderr | src/lib/api/auth.test.ts > API Client - auth > Error handling > handles network error
[2025-11-22T03:34:57.925Z] ERROR: API Error: POST /api/auth/login {"duration":0.08237499999995634} Error: Network error
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/lib/api/auth.test.ts:329:39
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

stdout | src/lib/api/auth.test.ts > API Client - auth > ApiError > creates ApiError with error message from response
[2025-11-22T03:34:57.928Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > ApiError > creates ApiError with error message from response
[2025-11-22T03:34:57.928Z] WARN: API Response: POST /api/auth/login - 400 (0.04ms)

stdout | src/lib/api/auth.test.ts > API Client - auth > ApiError > creates ApiError with statusText when no error message
[2025-11-22T03:34:57.928Z] DEBUG: API Request: POST /api/auth/login

stderr | src/lib/api/auth.test.ts > API Client - auth > ApiError > creates ApiError with statusText when no error message
[2025-11-22T03:34:57.928Z] WARN: API Response: POST /api/auth/login - 404 (0.03ms)

 âœ“ src/lib/api/auth.test.ts (17 tests) 13ms
stdout | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should clear form after successful submission
[2025-11-22T03:34:57.939Z] INFO: Password changed successfully

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Logout > throws error but still clears user state
[2025-11-22T03:34:57.942Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stderr | src/contexts/AuthContext.test.tsx > AuthContext > Logout > throws error but still clears user state
[2025-11-22T03:34:57.994Z] ERROR: Logout failed Error: Server error
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/contexts/AuthContext.test.tsx:173:53
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

stdout | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should disable form during submission
[2025-11-22T03:34:58.006Z] INFO: Password changed successfully

stdout | src/contexts/AuthContext.test.tsx > AuthContext > isAuthenticated > returns true when user is set
[2025-11-22T03:34:58.047Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stderr | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should show error message on API error
[2025-11-22T03:34:58.071Z] ERROR: Failed to change password Error: ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/components/settings/PasswordChangeForm.test.tsx:229:24
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

stdout | src/contexts/AuthContext.test.tsx > AuthContext > isAuthenticated > returns false when user is null
[2025-11-22T03:34:58.101Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > useAuth hook > provides all required properties
[2025-11-22T03:34:58.105Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/components/settings/PasswordChangeForm.test.tsx > PasswordChangeForm > Form Submission > should clear previous error on new submission
[2025-11-22T03:34:58.139Z] INFO: Password changed successfully

 âœ“ src/components/settings/PasswordChangeForm.test.tsx (16 tests) 799ms
stdout | src/contexts/AuthContext.test.tsx > AuthContext > useAuth hook > login is a function
[2025-11-22T03:34:58.158Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > useAuth hook > logout is a function
[2025-11-22T03:34:58.210Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > AuthProvider component > renders children
[2025-11-22T03:34:58.266Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > AuthProvider component > provides context value to children
[2025-11-22T03:34:58.267Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Integration scenarios > handles complete authentication lifecycle and session management
[2025-11-22T03:34:58.268Z] DEBUG: Authentication restored from cookie {"userId":1,"email":"test@example.com"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Integration scenarios > handles complete authentication lifecycle and session management
[2025-11-22T03:34:58.320Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Integration scenarios > handles complete authentication lifecycle and session management
[2025-11-22T03:34:58.372Z] DEBUG: Not authenticated on mount {"error":{}}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Integration scenarios > handles complete authentication lifecycle and session management
[2025-11-22T03:34:58.424Z] INFO: User logged in {"userId":1,"email":"test@example.com","role":"user"}

stdout | src/contexts/AuthContext.test.tsx > AuthContext > Integration scenarios > handles complete authentication lifecycle and session management
[2025-11-22T03:34:58.477Z] INFO: User logged out

 âœ“ src/contexts/AuthContext.test.tsx (20 tests) 1245ms
stderr | src/components/admin/InitialPasswordModal.test.tsx > InitialPasswordModal > Copy Functionality > should handle clipboard error gracefully
[2025-11-22T03:34:59.452Z] ERROR: Failed to copy password Error: Clipboard error
    at [90m/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39msrc/components/admin/InitialPasswordModal.test.tsx:117:38
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@3.2.4/node_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 âœ“ src/components/admin/InitialPasswordModal.test.tsx (12 tests) 2190ms
   âœ“ InitialPasswordModal > Copy Functionality > should reset button text after 2 seconds  2125ms

â¯â¯â¯â¯â¯â¯ Failed Suites 2 â¯â¯â¯â¯â¯â¯â¯

 FAIL  src/components/admin/UserCreateForm.test.tsx [ src/components/admin/UserCreateForm.test.tsx ]
Error: Transform failed with 1 error:
/Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/src/components/admin/UserCreateForm.tsx:110:0: ERROR: Unterminated string literal
  Plugin: vite:esbuild
  File: /Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/src/components/admin/UserCreateForm.tsx:110:0
  
  Unterminated string literal
  108 |    )
  109 |  }
  110 |  
      |  ^
  
 â¯ failureErrorWithLog node_modules/.pnpm/esbuild@0.25.12/node_modules/esbuild/lib/main.js:1467:15
 â¯ node_modules/.pnpm/esbuild@0.25.12/node_modules/esbuild/lib/main.js:736:50
 â¯ responseCallbacks.<computed> node_modules/.pnpm/esbuild@0.25.12/node_modules/esbuild/lib/main.js:603:9
 â¯ handleIncomingPacket node_modules/.pnpm/esbuild@0.25.12/node_modules/esbuild/lib/main.js:658:12
 â¯ Socket.readFromStdout node_modules/.pnpm/esbuild@0.25.12/node_modules/esbuild/lib/main.js:581:7

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/2]â¯

 FAIL  src/components/admin/UserList.test.tsx [ src/components/admin/UserList.test.tsx ]
Error: Failed to resolve import "@/lib/api/todos" from "src/components/admin/UserList.tsx". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/tomoki_ishimine/Workspace/fullstack-app-with-claude/frontend/src/components/admin/UserList.tsx:5:25
  3  |  import { deleteUser } from "@/lib/api/users";
  4  |  import { logger } from "@/lib/logger";
  5  |  import { ApiError } from "@/lib/api/todos";
     |                            ^
  6  |  export function UserList({ users, onUsersChange }) {
  7  |    const [deletingUserId, setDeletingUserId] = useState(null);
 â¯ TransformPluginContext._formatLog node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:31106:43
 â¯ TransformPluginContext.error node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:31103:14
 â¯ normalizeUrl node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:29590:18
 â¯ node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:29648:32
 â¯ TransformPluginContext.transform node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:29616:4
 â¯ EnvironmentPluginContainer.transform node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:30905:14
 â¯ loadAndTransform node_modules/.pnpm/vite@7.1.12_@types+node@24.9.2_jiti@2.6.1/node_modules/vite/dist/node/chunks/config.js:26043:26

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/2]â¯


 Test Files  2 failed | 10 passed (12)
      Tests  166 passed (166)
   Start at  12:34:55
   Duration  3.76s (transform 489ms, setup 4.63s, collect 1.50s, tests 4.58s, environment 4.03s, prepare 1.32s)

